<div class="highlight" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span><span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">RNN_model</span>():

    hid_nodes_lstm <span style="color: #666666">=</span> <span style="color: #666666">32</span>
    rnn_model <span style="color: #666666">=</span> Sequential()
    rnn_model<span style="color: #666666">.</span>add(BatchNormalization(input_shape<span style="color: #666666">=</span>(WINDOW_SAMPLES, SENS_VALUES)))
    rnn_model<span style="color: #666666">.</span>add(LSTM(units<span style="color: #666666">=</span>hid_nodes_lstm, return_sequences<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, name<span style="color: #666666">=</span><span style="color: #BA2121">'RNN1'</span>))
    rnn_model<span style="color: #666666">.</span>add(Dropout(<span style="color: #666666">0.2</span>))
    rnn_model<span style="color: #666666">.</span>add(LSTM(units<span style="color: #666666">=</span>hid_nodes_lstm, return_sequences<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, name<span style="color: #666666">=</span><span style="color: #BA2121">'RNN2'</span>))
    rnn_model<span style="color: #666666">.</span>add(Dropout(<span style="color: #666666">0.2</span>))
    rnn_model<span style="color: #666666">.</span>add(LSTM(units<span style="color: #666666">=</span>hid_nodes_lstm, return_sequences<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">True</span>, name<span style="color: #666666">=</span><span style="color: #BA2121">'RNN3'</span>))
    rnn_model<span style="color: #666666">.</span>add(Dropout(<span style="color: #666666">0.2</span>))
    rnn_model<span style="color: #666666">.</span>add(LSTM(units<span style="color: #666666">=</span>hid_nodes_lstm, return_sequences<span style="color: #666666">=</span><span style="color: #008000; font-weight: bold">False</span>, name<span style="color: #666666">=</span><span style="color: #BA2121">'RNN4'</span>))
    rnn_model<span style="color: #666666">.</span>add(Dropout(<span style="color: #666666">0.2</span>))
    rnn_model<span style="color: #666666">.</span>add(Dense(num_classes, activation<span style="color: #666666">=</span><span style="color: #BA2121">'softmax'</span>))

    model_summary(rnn_model, mod_type<span style="color: #666666">=</span><span style="color: #BA2121">'RNN'</span>)
    <span style="color: #008000; font-weight: bold">return</span> rnn_model
</pre></div>
